<?xml version="1.0" ?>
<sphInput>
    <Variables>
        <!-- Some variables are automatically defined:
        t = Simulation time.
        dt = time step.
        step = Number of the time step.
        n = Number of particles.
        n_sensors = Number of sensors
        N = Total number of particles (n + n_sensors)
        n_sets = Number of different sets of particles (each set may have different properties)
        n_radix = Rounded up value from N which is a power of 2
        n_cells = Number of cells (initialized as [0,0,0,0])
        support = Kernel support (as a factor of the kernel length "h")
        pos = Vector of particles positions (it should be read from an input file)
        iset = Particles set of each particle
        id_sorted = Permutations from unsorted space to sorted space
        id_unsorted = Permutations from sorted space to unsorted space
        icell = Cell where each particle is placed
        ihoc = First particle in each cell
         -->
        <Variable name="g" type="vec" value="0.0, 0.0, -9.81, 0.0" save="false" />
        <Variable name="cs" type="float" value="15.0" save="false" />
        <Variable name="rho_min" type="float" value="0.0" save="false" />
        <Variable name="rho_max" type="float" value="2.25*10^10" save="false" />
        <Variable name="pos_min" type="vec" save="false" />
        <Variable name="pos_max" type="vec" save="false" />

        <Variable name="gamma" type="float*" length="n_sets" save="false" />
        <Variable name="refd" type="float*" length="n_sets" save="false" />
        <Variable name="visc_dyn" type="float*" length="n_sets" save="false" />
        <Variable name="delta" type="float*" length="n_sets" save="false" />
        <Variable name="imove" type="int*" length="N" save="true" />
        <Variable name="normal" type="vec*" length="N" save="true" />
        <Variable name="v" type="vec*" length="N" save="true" />
        <Variable name="dvdt" type="vec*" length="N" save="true" />
        <Variable name="rho" type="float*" length="N" save="true" />
        <Variable name="drhodt" type="float*" length="N" save="true" />
        <Variable name="mass" type="float*" length="N" save="true" />
        <Variable name="press" type="float*" length="N" save="true" />

        <Variable name="pos_in" type="vec*" length="N" save="true" />
        <Variable name="v_in" type="vec*" length="N" save="true" />
        <Variable name="dvdt_in" type="vec*" length="N" save="true" />
        <Variable name="rho_in" type="float*" length="N" save="true" />
        <Variable name="drhodt_in" type="float*" length="N" save="true" />
    </Variables>

    <Tools>
        <Tool action="add" type="copy" name="Init pos" in="pos" out="pos_in"/>
        <Tool action="add" type="copy" name="Init v" in="v" out="v_in"/>
        <Tool action="add" type="set" name="Init dvdt" in="dvdt_in" value="VEC_ZERO"/>
        <Tool action="add" type="copy" name="Init rho" in="rho" out="rho_in"/>
        <Tool action="add" type="set" name="Init drhodt" in="drhodt_in" value="0.f"/>
        <Tool action="add" type="kernel" name="Predictor" path="@RESOURCES_OUTPUT_DIR@/OpenCL/Predictor.cl"/>
        <Tool action="add" type="reduction" name="Minimum position" in="pos" out="pos_min" null="VEC_INFINITY">
            c.x = (a.x &lt; b.x) ? a.x : b.x;
            c.y = (a.y &lt; b.y) ? a.y : b.y;
            #ifdef HAVE_3D
                c.z = (a.z &lt; b.z) ? a.z : b.z;
                c.w = 0.f;
            #endif
        </Tool>
        <Tool action="add" type="reduction" name="Maximum position" in="pos" out="pos_max" null="VEC_NEG_INFINITY">
            c.x = (a.x &gt; b.x) ? a.x : b.x;
            c.y = (a.y &gt; b.y) ? a.y : b.y;
            #ifdef HAVE_3D
                c.z = (a.z &gt; b.z) ? a.z : b.z;
                c.w = 0.f;
            #endif
        </Tool>
    </Tools>
</sphInput>
